// Copyright 2025 Xin Huang
//
// GNU General Public License v3.0
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program. If not, please see
//
//    https://www.gnu.org/licenses/gpl-3.0.en.html

initialize() {
    initializeMutationRate(1.5e-8);
    initializeMutationType("m1", 0.5, "f", 0.0);
    initializeGenomicElementType("g1", m1, 1.0);
    initializeGenomicElement(g1, 0, 39999);
    initializeRecombinationRate(1e-8);
}

1 early() {
    sim.addSubpop("p1", 10000); 
}

200001 early() {
    sim.addSubpopSplit("p2", 10000, p1);
}

212001 early() {
    sim.addSubpopSplit("p3", 10000, p2);
}

214401 early() {
    p2.setMigrationRates(p1, 0.02);
}

214402 early() {
    p2.setMigrationRates(p1, 0);
}

214500 late() {
    p1.outputVCFSample(1); // Source
}

216000 late() { 
    p2.outputVCFSample(503); // Target
    p3.outputVCFSample(1008); // Reference
}
